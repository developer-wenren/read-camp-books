## 第一部分 资金实例

测试驱动开发目的在于编写整洁可用的代码，先达到**可用**的目标，再解决**整洁**的目标。

**测试驱动开发主要过程：**

- 加入一个小测试
- 运行所有测试，出现失败
- 适当修改
- 运行测试且成功
- 重构，去重复，简化结构

> 有出现副作用，坏味道的代码，就要转换为一个测试用例，并完成这个测试。

**保证测试运行的三个方法：**

- 伪实现 — 返回一个常量，并逐渐用变量代替常量。
- 显明实现 — 编写真实的实现代码
- **三角法** — 列举不同分支情况，用统一代码实现对应不同的结果 （跑通多种不同情况的 test case）

## 测试开发驱动模式

保证测试相互独立，没有依赖顺序。

准备测试清单。

何时写测试？在实现功能代码前写，不能时候事后测试。

何时写断言？从写测试时开始编写断言。

- 什么是正确的结果
- 如何检查结果的正确性

如何准备测试数据？

- 使用简单，易理解的数据
- 真实数据

## 测试模式

Mock 对象：用于测试一个依赖复杂资源的对象，比如数据库。

## 可运行模式

**伪实现**：返回一个常量，一旦测试运行起来，常量逐渐转换为变量表示的表达式。

**三角法**：正对一个功能提供两个或以上的测试用例，然后进行功能实现。

**显示实现**：明确如何实现，就使用显示方式完成实现代码，然后进行测试。



## 重构

**整合差异**： 从两段相似的代码里提供，一步步减少差异。

**隔离变化**：将变化部分提取出来，单独处理。

**数据迁移**：先改变内部的表示形式，再改变外部的可见接口。

**提取方法**：将一个又长又复杂的方法转变成一个个单独的方法。

**内联方法**：简化流程控制，将调用方法的地方与方法本身内联起来。

**提取接口**：声明一个接口，将类的方法迁移至接口，并进行实现。

**转移方法**：将一个方法转移到另一个类中。

**方法对象**：将方法中需要许多参数，组成一个对象。

**添加参数**：在旧方法的基础上，添加新参数。

**方法参数转为构造函数参数**：同一参数在一个对象中多个方法都被使用到时，只需通过构造函数传递一次即可。


